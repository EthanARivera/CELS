<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      xmlns:p="http://primefaces.org/ui">

<h:head>
    <title>Agregar Material</title>
    <h:outputStylesheet name="style.css"/>
    <script src="resources/funct.js"></script>

    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>

</h:head>

<h:body>

    <!-- Encabezado con botones -->
    <div class="header">
        <!-- Link para regresar -->
        <h:link outcome="consulta_materiales.xhtml" styleClass="back ui-button-success">
            <i class="pi pi-arrow-left"></i>
        </h:link>

        <span>Registro de materiales</span>

        <!-- Botón de menú -->
        <p:commandButton class="menu" icon="pi pi-bars"
                         onclick="toggleMenu(); return false;" />
    </div>

    <!-- Menú superior oculto -->
    <div id="menuPanel" class="menu-panel">
        <h:link outcome="consulta_materiales.xhtml" styleClass="menu-option">
            <i class="pi pi-box"></i> Consulta Materiales
        </h:link>

        <h:link outcome="consulta_usuarios.xhtml" styleClass="menu-option">
            <i class="pi pi-users"></i> Consulta Usuarios
        </h:link>

        <h:link outcome="consulta_cotizaciones.xhtml" styleClass="menu-option">
            <i class="pi pi-file"></i> Consulta Cotizaciones
        </h:link>
    </div>

    <p:messages id="msgs" showDetail="false" closable="true" /> <!--//Para mostrar los mensajes-->



    <h:form>
        <!-- Contenedor del formulario -->
        <div class="container">
            <div class="form-grid">

                <!-- Nombre del Material -->
                <p:outputLabel for="nombre" value="Nombre del Material: " />
                <p:inputText id="nombre" value="#{materialUI.material.nombre}"
                             required="true" requiredMessage="ERROR: El nombre es obligatorio"
                             placeholder="Ej. Vinil adhesivo" />

                <!-- Tipo de Material -->
                <p:outputLabel for="tipo" value="Tipo de Material: " />
                <p:inputText id="tipo" value="#{materialUI.material.tipoMaterial}"
                             required="true" requiredMessage="ERROR: El tipo de material es obligatorio"
                             placeholder="Ej. Lona, Acrílico, Vinil, etc." />

                <!-- Costo -->
                <p:outputLabel for="costo" value="Costo por Unidad:" />
                <p:inputText id="costo"
                             value="#{materialUI.material.costo}"
                             required="true"
                             requiredMessage="ERROR: El costo es obligatorio"
                             converterMessage="ERROR: El costo debe ser un número decimal válido"
                             validatorMessage="ERROR: El costo debe ser un número mayor a 0"
                             placeholder="Ej. 150.00">
                    <f:validateDoubleRange minimum="0.01" />
                </p:inputText>

                <!-- Tipo de Unidad -->
                <p:outputLabel for="unidad" value="Tipo de Unidad: " />
                <p:selectOneMenu id="unidad" value="#{materialUI.material.tipoUnidad}"
                                 required="true" requiredMessage="ERROR: Debe seleccionar un tipo de unidad" style="width:100%;">
                    <f:selectItem itemLabel="Seleccione una unidad" itemValue="#{null}" noSelectionOption="true" />
                    <f:selectItems value="#{materialUI.tiposUnidad}" var="u"
                                   itemLabel="#{u.label}" itemValue="#{u}" />
                </p:selectOneMenu>

            </div>

            <!-- Botones -->
            <div class="btn-container">
                <p:commandButton value="Agregar"
                                 actionListener="#{materialUI.guardar}"
                                 update="@form msgs"
                                 styleClass="btn-blue"
                                 oncomplete="if (!args.validationFailed) { setTimeout(function(){ window.location.href='consulta_materiales.xhtml'; }, 1500); }" /> <!--Retraso de 1.5s antes de la redirección para poder ver mensaje de éxito-->>

                <p:commandButton value="Cancelar"
                                 actionListener="#{materialUI.limpiarFormulario}"
                                 update="@form"
                                 styleClass="btn-blue"
                                 process="@this"
                                 immediate="true" /> <!--El process solo procesa el propio botón, ignora los campos del formulario. y el immediate Ejecuta la acción antes de las validaciones JSF-->

            </div>
        </div>
    </h:form>
</h:body>

</html>
